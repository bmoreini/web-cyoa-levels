var buttonElement = document.getElementById("button1");
var textTimer;
/*
function story(text) {
    var currentStoryElement = document.getElementById("currentStory");
    currentStoryElement.innerHTML = text;
}
*/

function setOptions(options) {
    var dropdown = document.getElementById("choices");
    while (dropdown.options.length) {
        dropdown.remove(0);
    }
    for (var i = 0; i < options.length; i++) {
        var option = new Option(options[i].choice, options[i].target);
        dropdown.options.add(option);
    }
    /*
    for (var i = 0; i < options.length; i++) {
        var option = new Option(options[i], options[i]);
        dropdown.options.add(option);
    }
    */
}

function displayStory(text, delay = false, append = false) {
    var currentStoryElement = document.getElementById("currentStory");
    if (typeof(text) === 'string') {
        currentStoryElement.innerHTML = text;
    } else if (delay) {
        // Disable the button to prevent making a selection before
        // full message is delivered.
        buttonElement.disabled = true;
        // Keep shifting strings from the array until it is empty.
        if (append) {
            currentStoryElement.innerHTML += `<br /><br />${text.shift()}`;
        } else {
            currentStoryElement.innerHTML = text.shift();
        }
        if (text.length) {
            setTimeout(function () {
                displayStory(text, delay, true);
            }, delay);
        } else {
            // Done. Re-enable button.
            buttonElement.disabled = false;
        }
    } else {
        currentStoryElement.innerHTML = text.join('<br /><br />');
    }
}

/*
function delayText(text, delay) {
    var currentStoryElement = document.getElementById("currentStory");
    var index = 0;
    story("");
    var callback = function (text) {

        story(currentStoryElement.innerHTML  + text[index]+ "<br />"+ "<br />");
        index += 1;
        if (index >text.length-1){
            clearInterval(timer);
        }
    }
    var timer = setInterval(function () {
        callback(text);
    }, delay);
}
*/

function setup() {
    // setOptions();
    setOptions([
        { choice: "test 1", target: "test1" },
        { choice: "test 2", target: "test2" },
        { choice: "test 3", target: "test3" }
    ]);
    var buttonElement = document.getElementById("button1");
    buttonElement.innerHTML = "What will you do?"; 
    buttonElement.onclick = function () {
        var dropdown = document.getElementById("choices");
        // console.log(dropdown.value);
        getScene(dropdown.value);
    }
}
